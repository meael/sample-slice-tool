{
  "project": "Audio Slice Tool",
  "branchName": "ralph/marker-interaction-undo-redo",
  "description": "Marker interaction refinement and undo/redo - Improve marker drag behavior, hover affordances, visual alignment, and add undo/redo/reset support",
  "userStories": [
    {
      "id": "US-001",
      "title": "Remove persistent marker active state",
      "description": "As a user, I want markers to only appear active while dragging so there's no confusing selected state.",
      "acceptanceCriteria": [
        "Marker active state is entered only when user starts dragging",
        "Marker active state is exited immediately when drag ends",
        "Clicking a marker without dragging does not change its visual state",
        "Remove any persistent selectedMarkerId or active marker concept from state",
        "Active styling (if any) only applies during drag operation",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Show drag arrows on marker hover",
      "description": "As a user, I want to see drag arrows when I hover over a marker so I know I can drag it.",
      "acceptanceCriteria": [
        "Drag arrows (<> or ↔) appear instantly on marker hover",
        "No click required to reveal drag affordances",
        "Arrows positioned to indicate horizontal drag direction",
        "Arrows disappear when hover ends",
        "Arrows styled subtly but visibly (match existing UI theme)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Expand marker hover and drag area",
      "description": "As a user, I want a slightly larger hit area for markers so they're easier to grab.",
      "acceptanceCriteria": [
        "Marker hover area extends ~4-6px beyond visible marker bounds",
        "Expanded area is invisible (hit-testing only, no visual change)",
        "Dragging can be initiated from anywhere within expanded area",
        "No unintended overlap with neighboring markers at close distances",
        "Expanded area does not interfere with section header UI",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Align keyboard badge and close icon correctly",
      "description": "As a user, I want the keyboard number badge and close icon properly aligned above the marker.",
      "acceptanceCriteria": [
        "Close (×) icon is centered directly above the marker line",
        "Keyboard mapping number (1-9) is positioned to the left of the close icon",
        "Both elements are horizontally aligned (same vertical position)",
        "Disabled sections do not display keyboard mapping label",
        "Layout remains stable during hover and drag interactions",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Implement undo/redo state management",
      "description": "As a developer, I need an undo/redo system to track marker and section changes.",
      "acceptanceCriteria": [
        "Create useUndoRedo hook or integrate undo/redo into useMarkers",
        "Track state snapshots for: marker movement, creation, deletion",
        "Track state snapshots for: section enable/disable, section rename",
        "Support multiple undo/redo steps (linear history stack)",
        "Expose canUndo, canRedo boolean flags",
        "Expose undo(), redo(), reset() functions",
        "History is cleared on reset()",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-006",
      "title": "Add undo/redo keyboard shortcuts",
      "description": "As a user, I want to use Cmd/Ctrl+Z to undo and Cmd/Ctrl+Shift+Z to redo.",
      "acceptanceCriteria": [
        "Cmd/Ctrl+Z triggers undo when canUndo is true",
        "Cmd/Ctrl+Shift+Z triggers redo when canRedo is true",
        "Shortcuts are disabled during audio playback",
        "Shortcuts do nothing when canUndo/canRedo is false",
        "Shortcuts don't trigger when focus is in text input field",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-007",
      "title": "Add undo/redo/reset UI buttons",
      "description": "As a user, I want visible buttons for undo, redo, and reset actions.",
      "acceptanceCriteria": [
        "Undo button with ↶ icon or similar arrow",
        "Redo button with ↷ icon or similar arrow",
        "Reset button with clear/trash icon or 'Reset' text",
        "Undo button disabled (visually) when canUndo is false",
        "Redo button disabled (visually) when canRedo is false",
        "All three buttons disabled during audio playback",
        "Buttons placed in toolbar/control area near existing controls",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-008",
      "title": "Add reset confirmation dialog",
      "description": "As a user, I want a confirmation dialog before reset so I don't accidentally lose work.",
      "acceptanceCriteria": [
        "Clicking reset button shows confirmation dialog/modal",
        "Dialog message: 'Reset all markers and sections? This cannot be undone.'",
        "Dialog has 'Cancel' and 'Reset' buttons",
        "Cancel closes dialog without any action",
        "Reset clears all markers/sections, closes dialog, clears undo history",
        "Reset bypasses undo history (cannot undo a reset)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": false,
      "notes": ""
    }
  ]
}
