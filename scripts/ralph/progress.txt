# Ralph Progress Log
Started: Sun Feb  1 16:04:08 EET 2026

## Codebase Patterns
- Use `import type` for type-only imports (verbatimModuleSyntax is enabled)
- Utils go in `src/utils/` directory
- Types go in `src/types/` directory with their own files
- Use `void` to silence unused parameter warnings when params are required by API but not used

---

## 2026-02-01 16:10 - US-001
- Implemented `getSections(markers, duration)` helper function in `src/utils/sections.ts`
- Created Section interface with fields: id, startMarker, endMarker, startTime, endTime, name
- Function returns sections only between consecutive markers (not before first or after last)
- Single marker returns empty array
- Files changed: `src/utils/sections.ts` (new file)
- **Learnings for future iterations:**
  - This codebase uses `verbatimModuleSyntax`, so type imports must use `import type`
  - Section name is inherited from `startMarker.name`
  - Section id format is `section-${startMarker.id}-${endMarker.id}`
---

## 2026-02-01 16:20 - US-002
- Moved Section interface from `src/utils/sections.ts` to dedicated type file `src/types/section.ts`
- Updated `src/utils/sections.ts` to import and re-export Section from new location
- Files changed: `src/types/section.ts` (new file), `src/utils/sections.ts` (updated imports)
- **Learnings for future iterations:**
  - Types should be in their own files in `src/types/` directory
  - Can re-export types from utils for convenience: `export type { Section } from '../types/section'`
  - Section type can be imported from either `src/types/section.ts` or `src/utils/sections.ts`
---

## 2026-02-01 16:35 - US-003
- Added `sections` prop to `WaveformCanvas` component interface
- Modified `drawWaveform` to render inactive areas (before first marker, after last marker) in grayscale
- Grayscale color calculated using luminance formula: `0.299*R + 0.587*G + 0.114*B`
- When no sections exist (backwards compatibility), entire waveform renders in normal color
- Updated `App.tsx` to calculate sections using `getSections` (via `useMemo`) and pass to `WaveformCanvas`
- Files changed: `src/components/WaveformCanvas.tsx`, `src/App.tsx`
- **Learnings for future iterations:**
  - Use `useMemo` to memoize expensive calculations like `getSections(markers, audioDuration)`
  - The waveform color is a hex string (e.g., `#22d3ee`), parse with regex to extract RGB
  - Grayscale rendering: convert RGB to single gray value using perceptual luminance weights
  - When modifying canvas drawing, ensure variables like `rangeStart` are not declared twice
---
